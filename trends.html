<!DOCTYPE html>
<html >

<head>

  <meta charset="UTF-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <title>Solutions to Time Series Analysis: with Applications in R</title>
  <meta name="description" content="This book contains solutions to the problems in the book Time Series Analysis with Applications in R, second edition, by Cryer and Chan. It is provided as a github repository so that anybody may contribute to its development.">
  <meta name="generator" content="bookdown 0.3.16 and GitBook 2.6.7">

  <meta property="og:title" content="Solutions to Time Series Analysis: with Applications in R" />
  <meta property="og:type" content="book" />
  
  <meta property="og:image" content="images/tsa.png" />
  <meta property="og:description" content="This book contains solutions to the problems in the book Time Series Analysis with Applications in R, second edition, by Cryer and Chan. It is provided as a github repository so that anybody may contribute to its development." />
  <meta name="github-repo" content="jolars/TSAsolutions" />

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="Solutions to Time Series Analysis: with Applications in R" />
  
  <meta name="twitter:description" content="This book contains solutions to the problems in the book Time Series Analysis with Applications in R, second edition, by Cryer and Chan. It is provided as a github repository so that anybody may contribute to its development." />
  <meta name="twitter:image" content="images/tsa.png" />

<meta name="author" content="Johan Larsson">


<meta name="date" content="2017-04-05">

  <meta name="viewport" content="width=device-width, initial-scale=1">
  <meta name="apple-mobile-web-app-capable" content="yes">
  <meta name="apple-mobile-web-app-status-bar-style" content="black">
  
  
<link rel="prev" href="fundamental-concepts.html">

<script src="libs/jquery-2.2.3/jquery.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />









<style type="text/css">
div.sourceCode { overflow-x: auto; }
table.sourceCode, tr.sourceCode, td.lineNumbers, td.sourceCode {
  margin: 0; padding: 0; vertical-align: baseline; border: none; }
table.sourceCode { width: 100%; line-height: 100%; }
td.lineNumbers { text-align: right; padding-right: 4px; padding-left: 4px; color: #aaaaaa; border-right: 1px solid #aaaaaa; }
td.sourceCode { padding-left: 5px; }
code > span.kw { color: #007020; font-weight: bold; } /* Keyword */
code > span.dt { color: #902000; } /* DataType */
code > span.dv { color: #40a070; } /* DecVal */
code > span.bn { color: #40a070; } /* BaseN */
code > span.fl { color: #40a070; } /* Float */
code > span.ch { color: #4070a0; } /* Char */
code > span.st { color: #4070a0; } /* String */
code > span.co { color: #60a0b0; font-style: italic; } /* Comment */
code > span.ot { color: #007020; } /* Other */
code > span.al { color: #ff0000; font-weight: bold; } /* Alert */
code > span.fu { color: #06287e; } /* Function */
code > span.er { color: #ff0000; font-weight: bold; } /* Error */
code > span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
code > span.cn { color: #880000; } /* Constant */
code > span.sc { color: #4070a0; } /* SpecialChar */
code > span.vs { color: #4070a0; } /* VerbatimString */
code > span.ss { color: #bb6688; } /* SpecialString */
code > span.im { } /* Import */
code > span.va { color: #19177c; } /* Variable */
code > span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code > span.op { color: #666666; } /* Operator */
code > span.bu { } /* BuiltIn */
code > span.ex { } /* Extension */
code > span.pp { color: #bc7a00; } /* Preprocessor */
code > span.at { color: #7d9029; } /* Attribute */
code > span.do { color: #ba2121; font-style: italic; } /* Documentation */
code > span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code > span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code > span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
</style>

</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li class="chapter" data-level="" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i>Preface</a><ul>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html#dependencies"><i class="fa fa-check"></i>Dependencies</a></li>
</ul></li>
<li class="chapter" data-level="1" data-path="introduction.html"><a href="introduction.html"><i class="fa fa-check"></i><b>1</b> Introduction</a><ul>
<li class="chapter" data-level="1.1" data-path="introduction.html"><a href="introduction.html#larain"><i class="fa fa-check"></i><b>1.1</b> Larain</a></li>
<li class="chapter" data-level="1.2" data-path="introduction.html"><a href="introduction.html#colors"><i class="fa fa-check"></i><b>1.2</b> Colors</a></li>
<li class="chapter" data-level="1.3" data-path="introduction.html"><a href="introduction.html#random-normal-time-series"><i class="fa fa-check"></i><b>1.3</b> Random, normal time series</a></li>
<li class="chapter" data-level="1.4" data-path="introduction.html"><a href="introduction.html#random-chi2-distributed-time-series"><i class="fa fa-check"></i><b>1.4</b> Random, <span class="math inline">\(\chi^2\)</span>-distributed time series</a></li>
<li class="chapter" data-level="1.5" data-path="introduction.html"><a href="introduction.html#t5-distributed-random-values"><i class="fa fa-check"></i><b>1.5</b> <em>t</em>(5)-distributed, random values</a></li>
<li class="chapter" data-level="1.6" data-path="introduction.html"><a href="introduction.html#dubuque-temperature-series"><i class="fa fa-check"></i><b>1.6</b> Dubuque temperature series</a></li>
</ul></li>
<li class="chapter" data-level="2" data-path="fundamental-concepts.html"><a href="fundamental-concepts.html"><i class="fa fa-check"></i><b>2</b> Fundamental concepts</a><ul>
<li class="chapter" data-level="2.1" data-path="fundamental-concepts.html"><a href="fundamental-concepts.html#basic-properties-of-expected-value-and-covariance"><i class="fa fa-check"></i><b>2.1</b> Basic properties of expected value and covariance</a><ul>
<li class="chapter" data-level="" data-path="fundamental-concepts.html"><a href="fundamental-concepts.html#a"><i class="fa fa-check"></i>a</a></li>
<li class="chapter" data-level="" data-path="fundamental-concepts.html"><a href="fundamental-concepts.html#b"><i class="fa fa-check"></i>b</a></li>
<li class="chapter" data-level="" data-path="fundamental-concepts.html"><a href="fundamental-concepts.html#c"><i class="fa fa-check"></i>c</a></li>
</ul></li>
<li class="chapter" data-level="2.2" data-path="fundamental-concepts.html"><a href="fundamental-concepts.html#dependence-and-covariance"><i class="fa fa-check"></i><b>2.2</b> Dependence and covariance</a></li>
<li class="chapter" data-level="2.3" data-path="fundamental-concepts.html"><a href="fundamental-concepts.html#strict-and-weak-stationarity"><i class="fa fa-check"></i><b>2.3</b> Strict and weak stationarity</a><ul>
<li class="chapter" data-level="" data-path="fundamental-concepts.html"><a href="fundamental-concepts.html#a-1"><i class="fa fa-check"></i>a</a></li>
<li class="chapter" data-level="" data-path="fundamental-concepts.html"><a href="fundamental-concepts.html#b-1"><i class="fa fa-check"></i>b</a></li>
<li class="chapter" data-level="" data-path="fundamental-concepts.html"><a href="fundamental-concepts.html#c-1"><i class="fa fa-check"></i>c</a></li>
</ul></li>
<li class="chapter" data-level="2.4" data-path="fundamental-concepts.html"><a href="fundamental-concepts.html#zero-mean-white-noise"><i class="fa fa-check"></i><b>2.4</b> Zero-mean white noise</a><ul>
<li class="chapter" data-level="" data-path="fundamental-concepts.html"><a href="fundamental-concepts.html#a-2"><i class="fa fa-check"></i>a</a></li>
<li class="chapter" data-level="" data-path="fundamental-concepts.html"><a href="fundamental-concepts.html#b-2"><i class="fa fa-check"></i>b</a></li>
</ul></li>
<li class="chapter" data-level="2.5" data-path="fundamental-concepts.html"><a href="fundamental-concepts.html#zero-mean-stationary-series"><i class="fa fa-check"></i><b>2.5</b> Zero-mean stationary series</a><ul>
<li class="chapter" data-level="" data-path="fundamental-concepts.html"><a href="fundamental-concepts.html#a-3"><i class="fa fa-check"></i>a</a></li>
<li class="chapter" data-level="" data-path="fundamental-concepts.html"><a href="fundamental-concepts.html#b-3"><i class="fa fa-check"></i>b</a></li>
<li class="chapter" data-level="" data-path="fundamental-concepts.html"><a href="fundamental-concepts.html#c-2"><i class="fa fa-check"></i>c</a></li>
</ul></li>
<li class="chapter" data-level="2.6" data-path="fundamental-concepts.html"><a href="fundamental-concepts.html#stationary-time-series"><i class="fa fa-check"></i><b>2.6</b> Stationary time series</a><ul>
<li class="chapter" data-level="" data-path="fundamental-concepts.html"><a href="fundamental-concepts.html#a-4"><i class="fa fa-check"></i>a</a></li>
<li class="chapter" data-level="" data-path="fundamental-concepts.html"><a href="fundamental-concepts.html#b-4"><i class="fa fa-check"></i>b</a></li>
</ul></li>
<li class="chapter" data-level="2.7" data-path="fundamental-concepts.html"><a href="fundamental-concepts.html#first-and-second-order-difference-series"><i class="fa fa-check"></i><b>2.7</b> First and second-order difference series</a><ul>
<li class="chapter" data-level="" data-path="fundamental-concepts.html"><a href="fundamental-concepts.html#a-5"><i class="fa fa-check"></i>a</a></li>
<li class="chapter" data-level="" data-path="fundamental-concepts.html"><a href="fundamental-concepts.html#b-5"><i class="fa fa-check"></i>b</a></li>
</ul></li>
<li class="chapter" data-level="2.8" data-path="fundamental-concepts.html"><a href="fundamental-concepts.html#generalized-difference-series"><i class="fa fa-check"></i><b>2.8</b> Generalized difference series</a></li>
<li class="chapter" data-level="2.9" data-path="fundamental-concepts.html"><a href="fundamental-concepts.html#zero-mean-stationary-difference-series"><i class="fa fa-check"></i><b>2.9</b> Zero-mean stationary difference series</a><ul>
<li class="chapter" data-level="" data-path="fundamental-concepts.html"><a href="fundamental-concepts.html#a-6"><i class="fa fa-check"></i>a</a></li>
<li class="chapter" data-level="" data-path="fundamental-concepts.html"><a href="fundamental-concepts.html#b-6"><i class="fa fa-check"></i>b</a></li>
</ul></li>
<li class="chapter" data-level="2.10" data-path="fundamental-concepts.html"><a href="fundamental-concepts.html#zero-mean-unit-variance-process"><i class="fa fa-check"></i><b>2.10</b> Zero-mean, unit-variance process</a><ul>
<li class="chapter" data-level="" data-path="fundamental-concepts.html"><a href="fundamental-concepts.html#a-7"><i class="fa fa-check"></i>a</a></li>
<li class="chapter" data-level="" data-path="fundamental-concepts.html"><a href="fundamental-concepts.html#b-7"><i class="fa fa-check"></i>b</a></li>
<li class="chapter" data-level="" data-path="fundamental-concepts.html"><a href="fundamental-concepts.html#c-3"><i class="fa fa-check"></i>c</a></li>
</ul></li>
<li class="chapter" data-level="2.11" data-path="fundamental-concepts.html"><a href="fundamental-concepts.html#drift"><i class="fa fa-check"></i><b>2.11</b> Drift</a><ul>
<li class="chapter" data-level="" data-path="fundamental-concepts.html"><a href="fundamental-concepts.html#a-8"><i class="fa fa-check"></i>a</a></li>
<li class="chapter" data-level="" data-path="fundamental-concepts.html"><a href="fundamental-concepts.html#b-8"><i class="fa fa-check"></i>b</a></li>
</ul></li>
<li class="chapter" data-level="2.12" data-path="fundamental-concepts.html"><a href="fundamental-concepts.html#periods"><i class="fa fa-check"></i><b>2.12</b> Periods</a></li>
<li class="chapter" data-level="2.13" data-path="fundamental-concepts.html"><a href="fundamental-concepts.html#drift-part-2"><i class="fa fa-check"></i><b>2.13</b> Drift, part 2</a><ul>
<li class="chapter" data-level="" data-path="fundamental-concepts.html"><a href="fundamental-concepts.html#a-9"><i class="fa fa-check"></i>a</a></li>
<li class="chapter" data-level="" data-path="fundamental-concepts.html"><a href="fundamental-concepts.html#b-9"><i class="fa fa-check"></i>b</a></li>
</ul></li>
<li class="chapter" data-level="2.14" data-path="fundamental-concepts.html"><a href="fundamental-concepts.html#stationarity-again"><i class="fa fa-check"></i><b>2.14</b> Stationarity, again</a><ul>
<li class="chapter" data-level="" data-path="fundamental-concepts.html"><a href="fundamental-concepts.html#a-10"><i class="fa fa-check"></i>a</a></li>
<li class="chapter" data-level="" data-path="fundamental-concepts.html"><a href="fundamental-concepts.html#b-10"><i class="fa fa-check"></i>b</a></li>
<li class="chapter" data-level="" data-path="fundamental-concepts.html"><a href="fundamental-concepts.html#c-4"><i class="fa fa-check"></i>c</a></li>
</ul></li>
<li class="chapter" data-level="2.15" data-path="fundamental-concepts.html"><a href="fundamental-concepts.html#random-variable-zero-mean"><i class="fa fa-check"></i><b>2.15</b> Random variable, zero mean</a><ul>
<li class="chapter" data-level="" data-path="fundamental-concepts.html"><a href="fundamental-concepts.html#a-11"><i class="fa fa-check"></i>a</a></li>
<li class="chapter" data-level="" data-path="fundamental-concepts.html"><a href="fundamental-concepts.html#b-11"><i class="fa fa-check"></i>b</a></li>
<li class="chapter" data-level="" data-path="fundamental-concepts.html"><a href="fundamental-concepts.html#c-5"><i class="fa fa-check"></i>c</a></li>
</ul></li>
<li class="chapter" data-level="2.16" data-path="fundamental-concepts.html"><a href="fundamental-concepts.html#mean-and-variance"><i class="fa fa-check"></i><b>2.16</b> Mean and variance</a></li>
<li class="chapter" data-level="2.17" data-path="fundamental-concepts.html"><a href="fundamental-concepts.html#variance-of-sample-mean"><i class="fa fa-check"></i><b>2.17</b> Variance of sample mean</a></li>
<li class="chapter" data-level="2.18" data-path="fundamental-concepts.html"><a href="fundamental-concepts.html#sample-variance"><i class="fa fa-check"></i><b>2.18</b> Sample variance</a><ul>
<li class="chapter" data-level="" data-path="fundamental-concepts.html"><a href="fundamental-concepts.html#a-12"><i class="fa fa-check"></i>a</a></li>
<li class="chapter" data-level="" data-path="fundamental-concepts.html"><a href="fundamental-concepts.html#b-12"><i class="fa fa-check"></i>b</a></li>
<li class="chapter" data-level="" data-path="fundamental-concepts.html"><a href="fundamental-concepts.html#c-6"><i class="fa fa-check"></i>c</a></li>
</ul></li>
<li class="chapter" data-level="2.19" data-path="fundamental-concepts.html"><a href="fundamental-concepts.html#random-walk-with-drift"><i class="fa fa-check"></i><b>2.19</b> Random walk with drift</a><ul>
<li class="chapter" data-level="" data-path="fundamental-concepts.html"><a href="fundamental-concepts.html#a-13"><i class="fa fa-check"></i>a</a></li>
<li class="chapter" data-level="" data-path="fundamental-concepts.html"><a href="fundamental-concepts.html#b-13"><i class="fa fa-check"></i>b</a></li>
<li class="chapter" data-level="" data-path="fundamental-concepts.html"><a href="fundamental-concepts.html#c-7"><i class="fa fa-check"></i>c</a></li>
</ul></li>
<li class="chapter" data-level="2.20" data-path="fundamental-concepts.html"><a href="fundamental-concepts.html#random-walk"><i class="fa fa-check"></i><b>2.20</b> Random walk</a><ul>
<li class="chapter" data-level="" data-path="fundamental-concepts.html"><a href="fundamental-concepts.html#a-14"><i class="fa fa-check"></i>a</a></li>
<li class="chapter" data-level="" data-path="fundamental-concepts.html"><a href="fundamental-concepts.html#b-14"><i class="fa fa-check"></i>b</a></li>
<li class="chapter" data-level="" data-path="fundamental-concepts.html"><a href="fundamental-concepts.html#c-8"><i class="fa fa-check"></i>c</a></li>
</ul></li>
<li class="chapter" data-level="2.21" data-path="fundamental-concepts.html"><a href="fundamental-concepts.html#random-walk-with-random-starting-value"><i class="fa fa-check"></i><b>2.21</b> Random walk with random starting value</a><ul>
<li class="chapter" data-level="" data-path="fundamental-concepts.html"><a href="fundamental-concepts.html#a-15"><i class="fa fa-check"></i>a</a></li>
<li class="chapter" data-level="" data-path="fundamental-concepts.html"><a href="fundamental-concepts.html#b-15"><i class="fa fa-check"></i>b</a></li>
<li class="chapter" data-level="" data-path="fundamental-concepts.html"><a href="fundamental-concepts.html#c-9"><i class="fa fa-check"></i>c</a></li>
<li class="chapter" data-level="" data-path="fundamental-concepts.html"><a href="fundamental-concepts.html#d"><i class="fa fa-check"></i>d</a></li>
</ul></li>
<li class="chapter" data-level="2.22" data-path="fundamental-concepts.html"><a href="fundamental-concepts.html#asymptotic-stationarity"><i class="fa fa-check"></i><b>2.22</b> Asymptotic stationarity</a><ul>
<li class="chapter" data-level="" data-path="fundamental-concepts.html"><a href="fundamental-concepts.html#a-16"><i class="fa fa-check"></i>a</a></li>
<li class="chapter" data-level="" data-path="fundamental-concepts.html"><a href="fundamental-concepts.html#b-16"><i class="fa fa-check"></i>b</a></li>
<li class="chapter" data-level="" data-path="fundamental-concepts.html"><a href="fundamental-concepts.html#c-10"><i class="fa fa-check"></i>c</a></li>
<li class="chapter" data-level="" data-path="fundamental-concepts.html"><a href="fundamental-concepts.html#d-1"><i class="fa fa-check"></i>d</a></li>
<li class="chapter" data-level="" data-path="fundamental-concepts.html"><a href="fundamental-concepts.html#e"><i class="fa fa-check"></i>e</a></li>
</ul></li>
<li class="chapter" data-level="2.23" data-path="fundamental-concepts.html"><a href="fundamental-concepts.html#stationarity-in-sums-of-stochastic-processes"><i class="fa fa-check"></i><b>2.23</b> Stationarity in sums of stochastic processes</a></li>
<li class="chapter" data-level="2.24" data-path="fundamental-concepts.html"><a href="fundamental-concepts.html#measurement-noise"><i class="fa fa-check"></i><b>2.24</b> Measurement noise</a></li>
<li class="chapter" data-level="2.25" data-path="fundamental-concepts.html"><a href="fundamental-concepts.html#random-cosine-wave"><i class="fa fa-check"></i><b>2.25</b> Random cosine wave</a></li>
<li class="chapter" data-level="2.26" data-path="fundamental-concepts.html"><a href="fundamental-concepts.html#semivariogram"><i class="fa fa-check"></i><b>2.26</b> Semivariogram</a><ul>
<li class="chapter" data-level="" data-path="fundamental-concepts.html"><a href="fundamental-concepts.html#a-17"><i class="fa fa-check"></i>a</a></li>
<li class="chapter" data-level="" data-path="fundamental-concepts.html"><a href="fundamental-concepts.html#b-17"><i class="fa fa-check"></i>b</a></li>
</ul></li>
<li class="chapter" data-level="2.27" data-path="fundamental-concepts.html"><a href="fundamental-concepts.html#polynomials"><i class="fa fa-check"></i><b>2.27</b> Polynomials</a><ul>
<li class="chapter" data-level="" data-path="fundamental-concepts.html"><a href="fundamental-concepts.html#a-18"><i class="fa fa-check"></i>a</a></li>
<li class="chapter" data-level="" data-path="fundamental-concepts.html"><a href="fundamental-concepts.html#b-18"><i class="fa fa-check"></i>b</a></li>
</ul></li>
<li class="chapter" data-level="2.28" data-path="fundamental-concepts.html"><a href="fundamental-concepts.html#random-cosine-wave-extended"><i class="fa fa-check"></i><b>2.28</b> Random cosine wave extended</a><ul>
<li class="chapter" data-level="" data-path="fundamental-concepts.html"><a href="fundamental-concepts.html#a-19"><i class="fa fa-check"></i>a</a></li>
<li class="chapter" data-level="" data-path="fundamental-concepts.html"><a href="fundamental-concepts.html#b-19"><i class="fa fa-check"></i>b</a></li>
</ul></li>
<li class="chapter" data-level="2.29" data-path="fundamental-concepts.html"><a href="fundamental-concepts.html#random-cosine-wave-further"><i class="fa fa-check"></i><b>2.29</b> Random cosine wave further</a><ul>
<li class="chapter" data-level="" data-path="fundamental-concepts.html"><a href="fundamental-concepts.html#a-20"><i class="fa fa-check"></i>a</a></li>
<li class="chapter" data-level="" data-path="fundamental-concepts.html"><a href="fundamental-concepts.html#b-20"><i class="fa fa-check"></i>b</a></li>
</ul></li>
<li class="chapter" data-level="2.30" data-path="fundamental-concepts.html"><a href="fundamental-concepts.html#rayleigh-distribution"><i class="fa fa-check"></i><b>2.30</b> Rayleigh distribution</a></li>
</ul></li>
<li class="chapter" data-level="3" data-path="trends.html"><a href="trends.html"><i class="fa fa-check"></i><b>3</b> Trends</a><ul>
<li class="chapter" data-level="3.1" data-path="trends.html"><a href="trends.html#least-squares-estimation-for-linear-regression-trend"><i class="fa fa-check"></i><b>3.1</b> Least squares estimation for linear regression trend</a></li>
<li class="chapter" data-level="3.2" data-path="trends.html"><a href="trends.html#variance-of-mean-estimator"><i class="fa fa-check"></i><b>3.2</b> Variance of mean estimator</a></li>
<li class="chapter" data-level="3.3" data-path="trends.html"><a href="trends.html#variance-of-mean-estimator-2"><i class="fa fa-check"></i><b>3.3</b> Variance of mean estimator #2</a></li>
<li class="chapter" data-level="3.4" data-path="trends.html"><a href="trends.html#hours"><i class="fa fa-check"></i><b>3.4</b> Hours</a><ul>
<li class="chapter" data-level="" data-path="trends.html"><a href="trends.html#a-21"><i class="fa fa-check"></i>a</a></li>
<li class="chapter" data-level="" data-path="trends.html"><a href="trends.html#b-21"><i class="fa fa-check"></i>b</a></li>
</ul></li>
<li class="chapter" data-level="3.5" data-path="trends.html"><a href="trends.html#wages"><i class="fa fa-check"></i><b>3.5</b> Wages</a><ul>
<li class="chapter" data-level="" data-path="trends.html"><a href="trends.html#a-22"><i class="fa fa-check"></i>a</a></li>
<li class="chapter" data-level="" data-path="trends.html"><a href="trends.html#b-22"><i class="fa fa-check"></i>b</a></li>
<li class="chapter" data-level="" data-path="trends.html"><a href="trends.html#c-11"><i class="fa fa-check"></i>c</a></li>
<li class="chapter" data-level="" data-path="trends.html"><a href="trends.html#d-2"><i class="fa fa-check"></i>d</a></li>
<li class="chapter" data-level="" data-path="trends.html"><a href="trends.html#e-1"><i class="fa fa-check"></i>e</a></li>
</ul></li>
<li class="chapter" data-level="3.6" data-path="trends.html"><a href="trends.html#beer-sales"><i class="fa fa-check"></i><b>3.6</b> Beer sales</a><ul>
<li class="chapter" data-level="" data-path="trends.html"><a href="trends.html#a-23"><i class="fa fa-check"></i>a</a></li>
<li class="chapter" data-level="" data-path="trends.html"><a href="trends.html#b-23"><i class="fa fa-check"></i>b</a></li>
<li class="chapter" data-level="" data-path="trends.html"><a href="trends.html#c-12"><i class="fa fa-check"></i>c</a></li>
<li class="chapter" data-level="" data-path="trends.html"><a href="trends.html#d-3"><i class="fa fa-check"></i>d</a></li>
<li class="chapter" data-level="" data-path="trends.html"><a href="trends.html#e-2"><i class="fa fa-check"></i>e</a></li>
<li class="chapter" data-level="" data-path="trends.html"><a href="trends.html#f"><i class="fa fa-check"></i>f</a></li>
</ul></li>
<li class="chapter" data-level="3.7" data-path="trends.html"><a href="trends.html#winnebago"><i class="fa fa-check"></i><b>3.7</b> Winnebago</a><ul>
<li class="chapter" data-level="" data-path="trends.html"><a href="trends.html#a-24"><i class="fa fa-check"></i>a</a></li>
<li class="chapter" data-level="" data-path="trends.html"><a href="trends.html#b-24"><i class="fa fa-check"></i>b</a></li>
<li class="chapter" data-level="" data-path="trends.html"><a href="trends.html#c-13"><i class="fa fa-check"></i>c</a></li>
<li class="chapter" data-level="" data-path="trends.html"><a href="trends.html#d-4"><i class="fa fa-check"></i>d</a></li>
<li class="chapter" data-level="" data-path="trends.html"><a href="trends.html#e-3"><i class="fa fa-check"></i>e</a></li>
<li class="chapter" data-level="" data-path="trends.html"><a href="trends.html#f-1"><i class="fa fa-check"></i>f</a></li>
</ul></li>
<li class="chapter" data-level="3.8" data-path="trends.html"><a href="trends.html#retail"><i class="fa fa-check"></i><b>3.8</b> Retail</a><ul>
<li class="chapter" data-level="" data-path="trends.html"><a href="trends.html#a-25"><i class="fa fa-check"></i>a</a></li>
<li class="chapter" data-level="" data-path="trends.html"><a href="trends.html#b-25"><i class="fa fa-check"></i>b</a></li>
<li class="chapter" data-level="" data-path="trends.html"><a href="trends.html#c-14"><i class="fa fa-check"></i>c</a></li>
</ul></li>
<li class="chapter" data-level="3.9" data-path="trends.html"><a href="trends.html#prescriptions"><i class="fa fa-check"></i><b>3.9</b> Prescriptions</a><ul>
<li class="chapter" data-level="" data-path="trends.html"><a href="trends.html#a-26"><i class="fa fa-check"></i>a</a></li>
<li class="chapter" data-level="" data-path="trends.html"><a href="trends.html#b-26"><i class="fa fa-check"></i>b</a></li>
<li class="chapter" data-level="" data-path="trends.html"><a href="trends.html#c-15"><i class="fa fa-check"></i>c</a></li>
<li class="chapter" data-level="" data-path="trends.html"><a href="trends.html#d-5"><i class="fa fa-check"></i>d</a></li>
</ul></li>
</ul></li>
</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">Solutions to Time Series Analysis: with Applications in R</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="trends" class="section level1">
<h1><span class="header-section-number">Chapter 3</span> Trends</h1>
<div id="least-squares-estimation-for-linear-regression-trend" class="section level2">
<h2><span class="header-section-number">3.1</span> Least squares estimation for linear regression trend</h2>
<p>We begin by taking the partial derivatives with respect to <span class="math inline">\(\beta_0\)</span>.</p>
<p><span class="math display">\[
\frac{\partial}{\partial{\beta_0}} \mathcal{Q}(\beta_0, \beta_1) =
  -2\sum_{t=1}^n (Y_t - \beta_0 - \beta_1 t)
\]</span></p>
<p>We set it to <span class="math inline">\(0\)</span> and from this retrieve</p>
\begin{align*}
-2\sum_{t=1}^n (Y_t - \beta_0 - \beta_1 t) = &amp; 0 \implies \\
\sum_{t=1}^n Y_t - n\beta_0 - \beta_1 \sum_{t=1}^n t = &amp; 0 \implies \\
\beta_0 = \frac{\sum_{t=1}^n Y_t - \beta_1 \sum_{t=1}^n t}{n} = &amp;
  \bar{Y} - \beta_1 \bar{t}
\end{align*}
<p>Next, we take the partial derivative with respect to <span class="math inline">\(\beta_1\)</span>;</p>
<p><span class="math display">\[
\frac{\partial}{\partial{\beta_1}} \mathcal{Q}(\beta_0, \beta_1) =
  -2\sum_{t=1}^n t(Y_t - \beta_0 - \beta_1 t)
\]</span></p>
<p>Setting this to <span class="math inline">\(0\)</span> as well, multiplying both sides with <span class="math inline">\(-1/2\)</span> and rearranging results in</p>
\begin{align*}
-2\sum_{t=1}^n t (Y_t - \beta_0 - \beta_1 t) = &amp; 0 \implies \\
\beta_1 \sum_{t=1}^n t^2 = &amp; \sum_{t=1}^n Y_t t - \beta_0 \sum_{t=1}^n t
\end{align*}
<p>Then, substituting with the result gained previously for <span class="math inline">\(\beta_0\)</span>, we get</p>
\begin{align*}
\beta_1 \sum_{t=1}^n t^2 = &amp; \sum_{t=1}^n Y_t t - 
 \left( \frac{\sum_{t=1}^n Y_t}{n} - \beta_1 \frac{\sum_{t=1}^n}{n} \right)
 \sum_{t=1}^n t \iff \\
\beta_1 \left( \sum_{t=1}^n t^2 - \frac{(\sum_{t=1}^n t)^2}{n} \right) = &amp; 
  \sum_{t=1}^n Y_t t - \frac{\sum_{t=1}^n Y_t \sum_{t=1}^n t}{n} \iff \\
\beta_1 = &amp; \frac{n\sum_{t=1}^n Y_tt - \sum_{t=1}^nY_t \sum_{t=1}^n t}{n \sum_{t=1}^n t^2 - \left( \sum_{t=1}^n t \right)^2} = 
  \frac{\sum_{t=1}^n (Y_t - \bar{Y})(t-\bar{t})}{\sum_{t=1}^n (t-\bar{t})^2} \quad \square
\end{align*}
</div>
<div id="variance-of-mean-estimator" class="section level2">
<h2><span class="header-section-number">3.2</span> Variance of mean estimator</h2>
<p><span class="math display">\[
  \bar{Y} = \frac{1}{n}\sum_{t=1}^n Y_t = \frac{1}{n} \sum_{t=1}^n(\mu + e_t - e_{t-1}) = 
    \mu + \frac{1}{n} \sum_{t=1}^n (e_t - e_{t-1}) = \mu + \frac{1}{n}(e_n - e_0)
\]</span></p>
<p><span class="math display">\[
  \text{Var}[\bar{Y}] = \text{Var}[\mu + \frac{1}{n}(e_n - e_0)] =
    \frac{1}{n^2}(\sigma_e^2 + \sigma_e^2) = \frac{2\sigma_e^2}{n^2}
\]</span></p>
<p>It is uncommon for the sample size to have such a large impact on the variance estimator for the sample mean.</p>
<p>Setting <span class="math inline">\(Y_t = \mu + e_t\)</span> instead gives</p>
<p><span class="math display">\[
  \bar{Y} = \frac{1}{n}\sum_{t=1}^n Y_t = \frac{1}{n} \sum_{t=1}^n(\mu + e_t) = 
    \mu + \frac{1}{n} \sum_{t=1}^n e_t
\]</span></p>
<p><span class="math display">\[
  \text{Var}[\bar{Y}] = \text{Var} \left[ \mu + \frac{1}{n} \sum_{t=1}^n e_t \right] =
    0 + \frac{1}{n^2} \times n \sigma_e^2 = \frac{\sigma_e^2}{n}.
\]</span></p>
</div>
<div id="variance-of-mean-estimator-2" class="section level2">
<h2><span class="header-section-number">3.3</span> Variance of mean estimator #2</h2>
<p><span class="math display">\[
  \bar{Y} = \frac{1}{n} \sum_{t=1}^n(\mu + e_t + e_{t-1}) = 
    \mu + \frac{1}{n} \sum_{t=1}^n (e_t + e_{t-1}) = \mu + \frac{1}{n} \left( e_n + e_0 + 2 \sum_{t=1}^{n-1} t \right)
\]</span></p>
<p><span class="math display">\[
  \text{Var}[\bar{Y}] = \frac{1}{n^2}(\sigma_e^2 + \sigma_e^2 + 4(n-1) \sigma_e^2 ) = \frac{1}{n^2}2(2n-1)\sigma_e^2
\]</span></p>
<p>Setting <span class="math inline">\(Y_t = \mu + e_t\)</span> instead gives the result from 3.2. We note that for large <span class="math inline">\(n\)</span> the variance if approximately four times larger with <span class="math inline">\(Y_t = \mu + e_t + e_{t-1}\)</span>.</p>
</div>
<div id="hours" class="section level2">
<h2><span class="header-section-number">3.4</span> Hours</h2>
<div id="a-21" class="section level3 unnumbered">
<h3>a</h3>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">library</span>(TSA)
<span class="kw">data</span>(<span class="st">&quot;hours&quot;</span>)
<span class="kw">xyplot</span>(hours)</code></pre></div>
<div class="figure"><span id="fig:unnamed-chunk-10"></span>
<img src="TSAsolutions_files/figure-html/unnamed-chunk-10-1.png" alt="Monthly values of the average hours worked per week in the U.S. manufacturing sector." width="576" />
<p class="caption">
Figure 3.1: Monthly values of the average hours worked per week in the U.S. manufacturing sector.
</p>
</div>
<p>In Figure 1 we see a steep incline between 83 and 84. There also appears to be a seasonal trend with generally longer work hours later in the year apart from the summer; 1984, however, does not exhibit as clear a pattern.</p>
</div>
<div id="b-21" class="section level3 unnumbered">
<h3>b</h3>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">months &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="st">&quot;J&quot;</span>, <span class="st">&quot;A&quot;</span>, <span class="st">&quot;S&quot;</span>, <span class="st">&quot;O&quot;</span>, <span class="st">&quot;N&quot;</span>, <span class="st">&quot;D&quot;</span>, <span class="st">&quot;J&quot;</span>, <span class="st">&quot;F&quot;</span>, <span class="st">&quot;M&quot;</span>, <span class="st">&quot;A&quot;</span>, <span class="st">&quot;M&quot;</span>, <span class="st">&quot;J&quot;</span>)

<span class="kw">xyplot</span>(hours, <span class="dt">panel =</span> function(x, y, ...) {
  <span class="kw">panel.xyplot</span>(x, y, ...)
  <span class="kw">panel.text</span>(<span class="dt">x =</span> x, <span class="dt">y =</span> y, <span class="dt">labels =</span> months)
})</code></pre></div>
<div class="figure"><span id="fig:unnamed-chunk-11"></span>
<img src="TSAsolutions_files/figure-html/unnamed-chunk-11-1.png" alt="Monthly values of average hours worked per week with superposed initials of months." width="576" />
<p class="caption">
Figure 3.2: Monthly values of average hours worked per week with superposed initials of months.
</p>
</div>
<p>Here, in Figure 2, our interpretation is largely the same. It is clear that December stands out as the month with the longest weekly work hours whilst February and January are low-points, demonstrating a clear trend.</p>
</div>
</div>
<div id="wages" class="section level2">
<h2><span class="header-section-number">3.5</span> Wages</h2>
<div id="a-22" class="section level3 unnumbered">
<h3>a</h3>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">data</span>(<span class="st">&quot;wages&quot;</span>)
<span class="kw">xyplot</span>(wages, <span class="dt">panel =</span> function(x, y, ...) {
  <span class="kw">panel.xyplot</span>(x, y, ...)
  <span class="kw">panel.text</span>(x, y, <span class="dt">labels =</span> months)
})</code></pre></div>
<div class="figure"><span id="fig:unnamed-chunk-12"></span>
<img src="TSAsolutions_files/figure-html/unnamed-chunk-12-1.png" alt="Monthly average hourly wages for workers in the U.S. apparel and textile industry." width="576" />
<p class="caption">
Figure 3.3: Monthly average hourly wages for workers in the U.S. apparel and textile industry.
</p>
</div>
<p>There is a positive trend with seasonality: August is a low-point for wages. Generally, there seems to be larger increases in the fall.</p>
</div>
<div id="b-22" class="section level3 unnumbered">
<h3>b</h3>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">wages_fit1 &lt;-<span class="st"> </span><span class="kw">lm</span>(wages ~<span class="st"> </span><span class="kw">time</span>(wages))
<span class="kw">summary</span>(wages_fit1)</code></pre></div>
<pre><code>## 
## Call:
## lm(formula = wages ~ time(wages))
## 
## Residuals:
##     Min      1Q  Median      3Q     Max 
## -0.2383 -0.0498  0.0194  0.0585  0.1314 
## 
## Coefficients:
##              Estimate Std. Error t value Pr(&gt;|t|)    
## (Intercept) -5.49e+02   1.11e+01   -49.2   &lt;2e-16 ***
## time(wages)  2.81e-01   5.62e-03    50.0   &lt;2e-16 ***
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1
## 
## Residual standard error: 0.083 on 70 degrees of freedom
## Multiple R-squared:  0.973,  Adjusted R-squared:  0.972 
## F-statistic: 2.5e+03 on 1 and 70 DF,  p-value: &lt;2e-16</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">wages_rst &lt;-<span class="st"> </span><span class="kw">rstudent</span>(wages_fit1)</code></pre></div>
</div>
<div id="c-11" class="section level3 unnumbered">
<h3>c</h3>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">xyplot</span>(wages_rst ~<span class="st"> </span><span class="kw">time</span>(wages_rst), <span class="dt">type =</span> <span class="st">&quot;l&quot;</span>,
       <span class="dt">xlab =</span> <span class="st">&quot;Time&quot;</span>, <span class="dt">ylab =</span> <span class="st">&quot;Studentized residuals&quot;</span>)</code></pre></div>
<div class="figure">
<img src="TSAsolutions_files/figure-html/wages_resid-1.png" alt="Residual plot" width="576" />
<p class="caption">
(#fig:wages_resid)Residual plot
</p>
</div>
<p>We still seem to have autocorrelation related to the time and not white noise.</p>
</div>
<div id="d-2" class="section level3 unnumbered">
<h3>d</h3>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">wages_fit2 &lt;-<span class="st"> </span><span class="kw">lm</span>(wages ~<span class="st"> </span><span class="kw">time</span>(wages) +<span class="st"> </span><span class="kw">I</span>(<span class="kw">time</span>(wages)^<span class="dv">2</span>))
<span class="kw">summary</span>(wages_fit2)</code></pre></div>
<pre><code>## 
## Call:
## lm(formula = wages ~ time(wages) + I(time(wages)^2))
## 
## Residuals:
##      Min       1Q   Median       3Q      Max 
## -0.14832 -0.04144  0.00156  0.05009  0.13984 
## 
## Coefficients:
##                   Estimate Std. Error t value Pr(&gt;|t|)    
## (Intercept)      -8.49e+04   1.02e+04   -8.34  4.9e-12 ***
## time(wages)       8.53e+01   1.03e+01    8.31  5.4e-12 ***
## I(time(wages)^2) -2.14e-02   2.59e-03   -8.28  6.1e-12 ***
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1
## 
## Residual standard error: 0.059 on 69 degrees of freedom
## Multiple R-squared:  0.986,  Adjusted R-squared:  0.986 
## F-statistic: 2.49e+03 on 2 and 69 DF,  p-value: &lt;2e-16</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">wages_rst2 &lt;-<span class="st"> </span><span class="kw">rstudent</span>(wages_fit2)</code></pre></div>
</div>
<div id="e-1" class="section level3 unnumbered">
<h3>e</h3>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">xyplot</span>(wages_rst2 ~<span class="st"> </span><span class="kw">time</span>(wages_rst), <span class="dt">type =</span> <span class="st">&quot;l&quot;</span>,
       <span class="dt">xlab =</span> <span class="st">&quot;Time&quot;</span>, <span class="dt">ylab =</span> <span class="st">&quot;Studentized residuals&quot;</span>)</code></pre></div>
<div class="figure">
<img src="TSAsolutions_files/figure-html/wages_quad_resid-1.png" alt="Residual plot for our quadratic model." width="576" />
<p class="caption">
(#fig:wages_quad_resid)Residual plot for our quadratic model.
</p>
</div>
<p>This looks more like random noise but there is still clear autocorrelation between the fitted residuals that we have yet to capture in our model.</p>
</div>
</div>
<div id="beer-sales" class="section level2">
<h2><span class="header-section-number">3.6</span> Beer sales</h2>
<div id="a-23" class="section level3 unnumbered">
<h3>a</h3>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">data</span>(beersales)
<span class="kw">xyplot</span>(beersales)</code></pre></div>
<div class="figure"><span id="fig:unnamed-chunk-15"></span>
<img src="TSAsolutions_files/figure-html/unnamed-chunk-15-1.png" alt="Monthly U.S. beer sales." width="576" />
<p class="caption">
Figure 3.4: Monthly U.S. beer sales.
</p>
</div>
<p>Clear seasonal trends. There is an initial positive trend from 1975 to around 1981 that then levels out.</p>
</div>
<div id="b-23" class="section level3 unnumbered">
<h3>b</h3>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">months &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="st">&quot;J&quot;</span>, <span class="st">&quot;F&quot;</span>, <span class="st">&quot;M&quot;</span>, <span class="st">&quot;A&quot;</span>, <span class="st">&quot;M&quot;</span>, <span class="st">&quot;J&quot;</span>, <span class="st">&quot;J&quot;</span>, <span class="st">&quot;A&quot;</span>, <span class="st">&quot;S&quot;</span>, <span class="st">&quot;O&quot;</span>, <span class="st">&quot;N&quot;</span>, <span class="st">&quot;D&quot;</span>)

<span class="kw">xyplot</span>(beersales,
       <span class="dt">panel =</span> function(x, y, ...) {
         <span class="kw">panel.xyplot</span>(x, y, ...)
         <span class="kw">panel.text</span>(x, y, <span class="dt">labels =</span> months)
       })</code></pre></div>
<div class="figure"><span id="fig:unnamed-chunk-16"></span>
<img src="TSAsolutions_files/figure-html/unnamed-chunk-16-1.png" alt="Monthly U.S. beer sales annotated with the months' initials." width="576" />
<p class="caption">
Figure 3.5: Monthly U.S. beer sales annotated with the months’ initials.
</p>
</div>
<p>It is now evident that the peaks are in the warm months and the slump in the winter and fall months. December is a particular low point, while May, June, and July seem to be the high points.</p>
</div>
<div id="c-12" class="section level3 unnumbered">
<h3>c</h3>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">beer_fit1 &lt;-<span class="st"> </span><span class="kw">lm</span>(beersales ~<span class="st"> </span><span class="kw">season</span>(beersales))
<span class="kw">pander</span>(<span class="kw">summary</span>(beer_fit1))</code></pre></div>
<table>
<colgroup>
<col width="42%" />
<col width="14%" />
<col width="16%" />
<col width="12%" />
<col width="12%" />
</colgroup>
<thead>
<tr class="header">
<th align="center"> </th>
<th align="center">Estimate</th>
<th align="center">Std. Error</th>
<th align="center">t value</th>
<th align="center">Pr(&gt;|t|)</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="center"><strong>season(beersales)February</strong></td>
<td align="center">-0.1426</td>
<td align="center">0.3732</td>
<td align="center">-0.382</td>
<td align="center">0.7029</td>
</tr>
<tr class="even">
<td align="center"><strong>season(beersales)March</strong></td>
<td align="center">2.082</td>
<td align="center">0.3732</td>
<td align="center">5.579</td>
<td align="center">8.771e-08</td>
</tr>
<tr class="odd">
<td align="center"><strong>season(beersales)April</strong></td>
<td align="center">2.398</td>
<td align="center">0.3732</td>
<td align="center">6.424</td>
<td align="center">1.151e-09</td>
</tr>
<tr class="even">
<td align="center"><strong>season(beersales)May</strong></td>
<td align="center">3.599</td>
<td align="center">0.3732</td>
<td align="center">9.643</td>
<td align="center">5.322e-18</td>
</tr>
<tr class="odd">
<td align="center"><strong>season(beersales)June</strong></td>
<td align="center">3.85</td>
<td align="center">0.3732</td>
<td align="center">10.31</td>
<td align="center">6.813e-20</td>
</tr>
<tr class="even">
<td align="center"><strong>season(beersales)July</strong></td>
<td align="center">3.769</td>
<td align="center">0.3732</td>
<td align="center">10.1</td>
<td align="center">2.812e-19</td>
</tr>
<tr class="odd">
<td align="center"><strong>season(beersales)August</strong></td>
<td align="center">3.609</td>
<td align="center">0.3732</td>
<td align="center">9.669</td>
<td align="center">4.494e-18</td>
</tr>
<tr class="even">
<td align="center"><strong>season(beersales)September</strong></td>
<td align="center">1.573</td>
<td align="center">0.3732</td>
<td align="center">4.214</td>
<td align="center">3.964e-05</td>
</tr>
<tr class="odd">
<td align="center"><strong>season(beersales)October</strong></td>
<td align="center">1.254</td>
<td align="center">0.3732</td>
<td align="center">3.361</td>
<td align="center">0.0009484</td>
</tr>
<tr class="even">
<td align="center"><strong>season(beersales)November</strong></td>
<td align="center">-0.04797</td>
<td align="center">0.3732</td>
<td align="center">-0.1285</td>
<td align="center">0.8979</td>
</tr>
<tr class="odd">
<td align="center"><strong>season(beersales)December</strong></td>
<td align="center">-0.4231</td>
<td align="center">0.3732</td>
<td align="center">-1.134</td>
<td align="center">0.2585</td>
</tr>
<tr class="even">
<td align="center"><strong>(Intercept)</strong></td>
<td align="center">12.49</td>
<td align="center">0.2639</td>
<td align="center">47.31</td>
<td align="center">1.786e-103</td>
</tr>
</tbody>
</table>
<table style="width:85%;">
<caption>Fitting linear model: beersales ~ season(beersales)</caption>
<colgroup>
<col width="20%" />
<col width="30%" />
<col width="11%" />
<col width="22%" />
</colgroup>
<thead>
<tr class="header">
<th align="center">Observations</th>
<th align="center">Residual Std. Error</th>
<th align="center"><span class="math inline">\(R^2\)</span></th>
<th align="center">Adjusted <span class="math inline">\(R^2\)</span></th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="center">192</td>
<td align="center">1.056</td>
<td align="center">0.7103</td>
<td align="center">0.6926</td>
</tr>
</tbody>
</table>
<p>All comparisons are made against january. The model helpfully explains approximately 0.71 of the variance and is statistically significant. Most of the factors are significant (mostly the winter months as expected).</p>
</div>
<div id="d-3" class="section level3 unnumbered">
<h3>d</h3>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">xyplot</span>(<span class="kw">rstudent</span>(beer_fit1) ~<span class="st"> </span><span class="kw">time</span>(beersales), <span class="dt">type =</span> <span class="st">&quot;l&quot;</span>,
       <span class="dt">xlab =</span> <span class="st">&quot;Time&quot;</span>, <span class="dt">ylab =</span> <span class="st">&quot;Studentized residuals&quot;</span>,
       <span class="dt">panel =</span> function(x, y, ...) {
         <span class="kw">panel.xyplot</span>(x, y, ...)
         <span class="kw">panel.xyplot</span>(x, y, <span class="dt">pch =</span> <span class="kw">as.vector</span>(<span class="kw">season</span>(beersales)), <span class="dt">col =</span> <span class="dv">1</span>)
       })</code></pre></div>
<div class="figure"><span id="fig:rst-beer"></span>
<img src="TSAsolutions_files/figure-html/rst-beer-1.png" alt="Beer sales residual plot." width="576" />
<p class="caption">
Figure 3.6: Beer sales residual plot.
</p>
</div>
<p>Looking at the residuals in <a href="trends.html#fig:rst-beer">3.6</a> We don’t have a good fit to our data; in particular, wee’re not capturing the long-term trend.</p>
</div>
<div id="e-2" class="section level3 unnumbered">
<h3>e</h3>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">beer_fit2 &lt;-<span class="st"> </span><span class="kw">lm</span>(beersales ~<span class="st"> </span><span class="kw">season</span>(beersales) +<span class="st"> </span><span class="kw">time</span>(beersales) +
<span class="st">                  </span><span class="kw">I</span>(<span class="kw">time</span>(beersales) ^<span class="st"> </span><span class="dv">2</span>))
<span class="kw">pander</span>(<span class="kw">summary</span>(beer_fit2))</code></pre></div>
<table>
<colgroup>
<col width="42%" />
<col width="14%" />
<col width="16%" />
<col width="12%" />
<col width="12%" />
</colgroup>
<thead>
<tr class="header">
<th align="center"> </th>
<th align="center">Estimate</th>
<th align="center">Std. Error</th>
<th align="center">t value</th>
<th align="center">Pr(&gt;|t|)</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="center"><strong>season(beersales)February</strong></td>
<td align="center">-0.1579</td>
<td align="center">0.209</td>
<td align="center">-0.7554</td>
<td align="center">0.451</td>
</tr>
<tr class="even">
<td align="center"><strong>season(beersales)March</strong></td>
<td align="center">2.052</td>
<td align="center">0.209</td>
<td align="center">9.818</td>
<td align="center">1.864e-18</td>
</tr>
<tr class="odd">
<td align="center"><strong>season(beersales)April</strong></td>
<td align="center">2.353</td>
<td align="center">0.209</td>
<td align="center">11.26</td>
<td align="center">1.533e-22</td>
</tr>
<tr class="even">
<td align="center"><strong>season(beersales)May</strong></td>
<td align="center">3.539</td>
<td align="center">0.209</td>
<td align="center">16.93</td>
<td align="center">6.063e-39</td>
</tr>
<tr class="odd">
<td align="center"><strong>season(beersales)June</strong></td>
<td align="center">3.776</td>
<td align="center">0.209</td>
<td align="center">18.06</td>
<td align="center">4.117e-42</td>
</tr>
<tr class="even">
<td align="center"><strong>season(beersales)July</strong></td>
<td align="center">3.681</td>
<td align="center">0.209</td>
<td align="center">17.61</td>
<td align="center">7.706e-41</td>
</tr>
<tr class="odd">
<td align="center"><strong>season(beersales)August</strong></td>
<td align="center">3.507</td>
<td align="center">0.2091</td>
<td align="center">16.78</td>
<td align="center">1.698e-38</td>
</tr>
<tr class="even">
<td align="center"><strong>season(beersales)September</strong></td>
<td align="center">1.458</td>
<td align="center">0.2091</td>
<td align="center">6.972</td>
<td align="center">5.89e-11</td>
</tr>
<tr class="odd">
<td align="center"><strong>season(beersales)October</strong></td>
<td align="center">1.126</td>
<td align="center">0.2091</td>
<td align="center">5.385</td>
<td align="center">2.268e-07</td>
</tr>
<tr class="even">
<td align="center"><strong>season(beersales)November</strong></td>
<td align="center">-0.1894</td>
<td align="center">0.2091</td>
<td align="center">-0.9059</td>
<td align="center">0.3662</td>
</tr>
<tr class="odd">
<td align="center"><strong>season(beersales)December</strong></td>
<td align="center">-0.5773</td>
<td align="center">0.2092</td>
<td align="center">-2.76</td>
<td align="center">0.00638</td>
</tr>
<tr class="even">
<td align="center"><strong>time(beersales)</strong></td>
<td align="center">71.96</td>
<td align="center">8.867</td>
<td align="center">8.115</td>
<td align="center">7.703e-14</td>
</tr>
<tr class="odd">
<td align="center"><strong>I(time(beersales)^2)</strong></td>
<td align="center">-0.0181</td>
<td align="center">0.002236</td>
<td align="center">-8.096</td>
<td align="center">8.633e-14</td>
</tr>
<tr class="even">
<td align="center"><strong>(Intercept)</strong></td>
<td align="center">-71498</td>
<td align="center">8791</td>
<td align="center">-8.133</td>
<td align="center">6.932e-14</td>
</tr>
</tbody>
</table>
<table style="width:85%;">
<caption>Fitting linear model: beersales ~ season(beersales) + time(beersales) + I(time(beersales)^2)</caption>
<colgroup>
<col width="20%" />
<col width="30%" />
<col width="11%" />
<col width="22%" />
</colgroup>
<thead>
<tr class="header">
<th align="center">Observations</th>
<th align="center">Residual Std. Error</th>
<th align="center"><span class="math inline">\(R^2\)</span></th>
<th align="center">Adjusted <span class="math inline">\(R^2\)</span></th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="center">192</td>
<td align="center">0.5911</td>
<td align="center">0.9102</td>
<td align="center">0.9036</td>
</tr>
</tbody>
</table>
<p>This model fits the data better, explaining roughly 0.91 of the variance.</p>
</div>
<div id="f" class="section level3 unnumbered">
<h3>f</h3>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">xyplot</span>(<span class="kw">rstudent</span>(beer_fit2) ~<span class="st"> </span><span class="kw">time</span>(beersales), <span class="dt">type =</span> <span class="st">&quot;l&quot;</span>,
       <span class="dt">xlab =</span> <span class="st">&quot;Time&quot;</span>, <span class="dt">yla =</span> <span class="st">&quot;Studentized residuals&quot;</span>,
       <span class="dt">panel =</span> function(x, y, ...) {
         <span class="kw">panel.xyplot</span>(x, y, ...)
         <span class="kw">panel.xyplot</span>(x, y, <span class="dt">pch =</span> <span class="kw">as.vector</span>(<span class="kw">season</span>(beersales)), <span class="dt">col =</span> <span class="dv">1</span>)
       })</code></pre></div>
<div class="figure"><span id="fig:rst-beer2"></span>
<img src="TSAsolutions_files/figure-html/rst-beer2-1.png" alt="Beer sales residual plot from the quadratic fit." width="576" />
<p class="caption">
Figure 3.7: Beer sales residual plot from the quadratic fit.
</p>
</div>
<p>Many of the values are still not being predicted successfully but at least we’re able to model the long term trend better.</p>
</div>
</div>
<div id="winnebago" class="section level2">
<h2><span class="header-section-number">3.7</span> Winnebago</h2>
<div id="a-24" class="section level3 unnumbered">
<h3>a</h3>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">data</span>(winnebago)
<span class="kw">xyplot</span>(winnebago)</code></pre></div>
<div class="figure"><span id="fig:unnamed-chunk-19"></span>
<img src="TSAsolutions_files/figure-html/unnamed-chunk-19-1.png" alt="Monthly unit sales of recreational vehicles from Winnebago." width="576" />
<p class="caption">
Figure 3.8: Monthly unit sales of recreational vehicles from Winnebago.
</p>
</div>
</div>
<div id="b-24" class="section level3 unnumbered">
<h3>b</h3>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">winn_fit1 &lt;-<span class="st"> </span><span class="kw">lm</span>(winnebago ~<span class="st"> </span><span class="kw">time</span>(winnebago))
<span class="kw">summary</span>(winn_fit1) %&gt;%
<span class="st">  </span><span class="kw">pander</span>()</code></pre></div>
<table style="width:92%;">
<colgroup>
<col width="30%" />
<col width="15%" />
<col width="18%" />
<col width="13%" />
<col width="13%" />
</colgroup>
<thead>
<tr class="header">
<th align="center"> </th>
<th align="center">Estimate</th>
<th align="center">Std. Error</th>
<th align="center">t value</th>
<th align="center">Pr(&gt;|t|)</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="center"><strong>time(winnebago)</strong></td>
<td align="center">200.7</td>
<td align="center">17.03</td>
<td align="center">11.79</td>
<td align="center">1.777e-17</td>
</tr>
<tr class="even">
<td align="center"><strong>(Intercept)</strong></td>
<td align="center">-394886</td>
<td align="center">33540</td>
<td align="center">-11.77</td>
<td align="center">1.87e-17</td>
</tr>
</tbody>
</table>
<table style="width:85%;">
<caption>Fitting linear model: winnebago ~ time(winnebago)</caption>
<colgroup>
<col width="20%" />
<col width="30%" />
<col width="11%" />
<col width="22%" />
</colgroup>
<thead>
<tr class="header">
<th align="center">Observations</th>
<th align="center">Residual Std. Error</th>
<th align="center"><span class="math inline">\(R^2\)</span></th>
<th align="center">Adjusted <span class="math inline">\(R^2\)</span></th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="center">64</td>
<td align="center">209.7</td>
<td align="center">0.6915</td>
<td align="center">0.6865</td>
</tr>
</tbody>
</table>
<p>The model is significant and explains 0.69 of the variance.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">xyplot</span>(<span class="kw">rstudent</span>(winn_fit1) ~<span class="st"> </span><span class="kw">time</span>(winnebago), <span class="dt">type =</span> <span class="st">&quot;l&quot;</span>,
       <span class="dt">xlab =</span> <span class="st">&quot;Time&quot;</span>, <span class="dt">ylab =</span> <span class="st">&quot;Studentized residuals&quot;</span>)</code></pre></div>
<div class="figure"><span id="fig:winnebago-lm-res"></span>
<img src="TSAsolutions_files/figure-html/winnebago-lm-res-1.png" alt="Residuals for the linear fit for the winnebago data." width="576" />
<p class="caption">
Figure 3.9: Residuals for the linear fit for the winnebago data.
</p>
</div>
<p>The fit is poor (Figure <a href="#winnebago-lm-res"><strong>??</strong></a>. It is not random and it is clear that we’re making worse predictions for later yers.</p>
</div>
<div id="c-13" class="section level3 unnumbered">
<h3>c</h3>
<p>To produce a better fit, we transform the outcome with the natural logarithm.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">winn_fit_log &lt;-<span class="st"> </span><span class="kw">lm</span>(<span class="kw">log</span>(winnebago) ~<span class="st"> </span><span class="kw">time</span>(winnebago))
<span class="kw">pander</span>(<span class="kw">summary</span>(winn_fit_log))</code></pre></div>
<table style="width:92%;">
<colgroup>
<col width="30%" />
<col width="15%" />
<col width="18%" />
<col width="13%" />
<col width="13%" />
</colgroup>
<thead>
<tr class="header">
<th align="center"> </th>
<th align="center">Estimate</th>
<th align="center">Std. Error</th>
<th align="center">t value</th>
<th align="center">Pr(&gt;|t|)</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="center"><strong>time(winnebago)</strong></td>
<td align="center">0.5031</td>
<td align="center">0.03199</td>
<td align="center">15.73</td>
<td align="center">2.575e-23</td>
</tr>
<tr class="even">
<td align="center"><strong>(Intercept)</strong></td>
<td align="center">-984.9</td>
<td align="center">62.99</td>
<td align="center">-15.64</td>
<td align="center">3.45e-23</td>
</tr>
</tbody>
</table>
<table style="width:85%;">
<caption>Fitting linear model: log(winnebago) ~ time(winnebago)</caption>
<colgroup>
<col width="20%" />
<col width="30%" />
<col width="11%" />
<col width="22%" />
</colgroup>
<thead>
<tr class="header">
<th align="center">Observations</th>
<th align="center">Residual Std. Error</th>
<th align="center"><span class="math inline">\(R^2\)</span></th>
<th align="center">Adjusted <span class="math inline">\(R^2\)</span></th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="center">64</td>
<td align="center">0.3939</td>
<td align="center">0.7996</td>
<td align="center">0.7964</td>
</tr>
</tbody>
</table>
<p>The model is better, explaining almost 0.8 of the variance.</p>
</div>
<div id="d-4" class="section level3 unnumbered">
<h3>d</h3>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">xyplot</span>(<span class="kw">rstudent</span>(winn_fit_log) ~<span class="st"> </span><span class="kw">time</span>(winnebago), <span class="dt">type =</span> <span class="st">&quot;l&quot;</span>,
       <span class="dt">xlab =</span> <span class="st">&quot;Time&quot;</span>, <span class="dt">ylab =</span> <span class="st">&quot;Studentized residuals&quot;</span>,
       <span class="dt">panel =</span> function(x, y, ...) {
         <span class="kw">panel.xyplot</span>(x, y, ...)
         <span class="kw">panel.xyplot</span>(x, y, <span class="dt">pch =</span> <span class="kw">as.vector</span>(<span class="kw">season</span>(winnebago)), <span class="dt">col =</span> <span class="dv">1</span>)
       })</code></pre></div>
<div class="figure"><span id="fig:winnebago-log-res"></span>
<img src="TSAsolutions_files/figure-html/winnebago-log-res-1.png" alt="Residual plot after natural log transformation." width="576" />
<p class="caption">
Figure 3.10: Residual plot after natural log transformation.
</p>
</div>
<p>This looks more like random noise (Figure <a href="#winnebago-log-res"><strong>??</strong></a>. Values still cling together somewhat but it is certainly better than the linear model. We’re still systematically overpredictinig the values for some months, however.</p>
</div>
<div id="e-3" class="section level3 unnumbered">
<h3>e</h3>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">winn_fit_seasonal &lt;-<span class="st"> </span><span class="kw">lm</span>(<span class="kw">log</span>(winnebago) ~<span class="st"> </span><span class="kw">season</span>(winnebago) +<span class="st"> </span><span class="kw">time</span>(winnebago))
<span class="kw">pander</span>(<span class="kw">summary</span>(winn_fit_seasonal))</code></pre></div>
<table>
<colgroup>
<col width="42%" />
<col width="14%" />
<col width="16%" />
<col width="12%" />
<col width="12%" />
</colgroup>
<thead>
<tr class="header">
<th align="center"> </th>
<th align="center">Estimate</th>
<th align="center">Std. Error</th>
<th align="center">t value</th>
<th align="center">Pr(&gt;|t|)</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="center"><strong>season(winnebago)February</strong></td>
<td align="center">0.6244</td>
<td align="center">0.1818</td>
<td align="center">3.434</td>
<td align="center">0.001188</td>
</tr>
<tr class="even">
<td align="center"><strong>season(winnebago)March</strong></td>
<td align="center">0.6822</td>
<td align="center">0.1909</td>
<td align="center">3.574</td>
<td align="center">0.0007793</td>
</tr>
<tr class="odd">
<td align="center"><strong>season(winnebago)April</strong></td>
<td align="center">0.8096</td>
<td align="center">0.1908</td>
<td align="center">4.243</td>
<td align="center">9.301e-05</td>
</tr>
<tr class="even">
<td align="center"><strong>season(winnebago)May</strong></td>
<td align="center">0.8695</td>
<td align="center">0.1907</td>
<td align="center">4.559</td>
<td align="center">3.246e-05</td>
</tr>
<tr class="odd">
<td align="center"><strong>season(winnebago)June</strong></td>
<td align="center">0.8631</td>
<td align="center">0.1907</td>
<td align="center">4.526</td>
<td align="center">3.627e-05</td>
</tr>
<tr class="even">
<td align="center"><strong>season(winnebago)July</strong></td>
<td align="center">0.5539</td>
<td align="center">0.1907</td>
<td align="center">2.905</td>
<td align="center">0.00542</td>
</tr>
<tr class="odd">
<td align="center"><strong>season(winnebago)August</strong></td>
<td align="center">0.5699</td>
<td align="center">0.1907</td>
<td align="center">2.988</td>
<td align="center">0.004305</td>
</tr>
<tr class="even">
<td align="center"><strong>season(winnebago)September</strong></td>
<td align="center">0.5757</td>
<td align="center">0.1907</td>
<td align="center">3.018</td>
<td align="center">0.00396</td>
</tr>
<tr class="odd">
<td align="center"><strong>season(winnebago)October</strong></td>
<td align="center">0.2635</td>
<td align="center">0.1908</td>
<td align="center">1.381</td>
<td align="center">0.1733</td>
</tr>
<tr class="even">
<td align="center"><strong>season(winnebago)November</strong></td>
<td align="center">0.2868</td>
<td align="center">0.1819</td>
<td align="center">1.577</td>
<td align="center">0.1209</td>
</tr>
<tr class="odd">
<td align="center"><strong>season(winnebago)December</strong></td>
<td align="center">0.248</td>
<td align="center">0.1818</td>
<td align="center">1.364</td>
<td align="center">0.1785</td>
</tr>
<tr class="even">
<td align="center"><strong>time(winnebago)</strong></td>
<td align="center">0.5091</td>
<td align="center">0.02571</td>
<td align="center">19.8</td>
<td align="center">1.351e-25</td>
</tr>
<tr class="odd">
<td align="center"><strong>(Intercept)</strong></td>
<td align="center">-997.3</td>
<td align="center">50.64</td>
<td align="center">-19.69</td>
<td align="center">1.718e-25</td>
</tr>
</tbody>
</table>
<table style="width:85%;">
<caption>Fitting linear model: log(winnebago) ~ season(winnebago) + time(winnebago)</caption>
<colgroup>
<col width="20%" />
<col width="30%" />
<col width="11%" />
<col width="22%" />
</colgroup>
<thead>
<tr class="header">
<th align="center">Observations</th>
<th align="center">Residual Std. Error</th>
<th align="center"><span class="math inline">\(R^2\)</span></th>
<th align="center">Adjusted <span class="math inline">\(R^2\)</span></th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="center">64</td>
<td align="center">0.3149</td>
<td align="center">0.8946</td>
<td align="center">0.8699</td>
</tr>
</tbody>
</table>
<p>The fit is improved further. We have a R<sup>2</sup> of 0.89 and significance for most of our seasonal means as well as the time trend.</p>
</div>
<div id="f-1" class="section level3 unnumbered">
<h3>f</h3>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">xyplot</span>(<span class="kw">rstudent</span>(winn_fit_seasonal) ~<span class="st"> </span><span class="kw">time</span>(winnebago), <span class="dt">type =</span> <span class="st">&quot;l&quot;</span>,
       <span class="dt">xlab =</span> <span class="st">&quot;Time&quot;</span>, <span class="dt">ylab =</span> <span class="st">&quot;Studentized residuals&quot;</span>,
       <span class="dt">panel =</span> function(x, y, ...) {
         <span class="kw">panel.xyplot</span>(x, y, ...)
         <span class="kw">panel.xyplot</span>(x, y, <span class="dt">col =</span> <span class="dv">1</span>, <span class="dt">pch =</span> <span class="kw">as.vector</span>(<span class="kw">season</span>(winnebago)))
       })</code></pre></div>
<p><img src="TSAsolutions_files/figure-html/unnamed-chunk-23-1.png" width="576" /></p>
<p>This is acceptable even if our residuals are quite large for some of the values, notably at the start of the series.</p>
</div>
</div>
<div id="retail" class="section level2">
<h2><span class="header-section-number">3.8</span> Retail</h2>
<div id="a-25" class="section level3 unnumbered">
<h3>a</h3>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">data</span>(retail)
<span class="kw">xyplot</span>(retail, <span class="dt">panel =</span> function(x, y, ...) {
  <span class="kw">panel.xyplot</span>(x, y, ...)
  <span class="kw">panel.xyplot</span>(x, y, <span class="dt">pch =</span> <span class="kw">as.vector</span>(<span class="kw">season</span>(retail)), <span class="dt">col =</span> <span class="dv">1</span>)
})</code></pre></div>
<div class="figure"><span id="fig:unnamed-chunk-24"></span>
<img src="TSAsolutions_files/figure-html/unnamed-chunk-24-1.png" alt="Total retail sales in the U.K. in billions pounds." width="576" />
<p class="caption">
Figure 3.11: Total retail sales in the U.K. in billions pounds.
</p>
</div>
<p>Plotting the retail sales trend there seems to be a long-term linear trend as well as heavy seasonality in tht December – and to slighter extent also November and October – exhibit regular surges in retail sales.</p>
</div>
<div id="b-25" class="section level3 unnumbered">
<h3>b</h3>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">retail_lm &lt;-<span class="st"> </span><span class="kw">lm</span>(retail ~<span class="st"> </span><span class="kw">season</span>(retail) +<span class="st"> </span><span class="kw">time</span>(retail))
<span class="kw">pander</span>(<span class="kw">summary</span>(retail_lm))</code></pre></div>
<table>
<colgroup>
<col width="40%" />
<col width="14%" />
<col width="17%" />
<col width="13%" />
<col width="13%" />
</colgroup>
<thead>
<tr class="header">
<th align="center"> </th>
<th align="center">Estimate</th>
<th align="center">Std. Error</th>
<th align="center">t value</th>
<th align="center">Pr(&gt;|t|)</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="center"><strong>season(retail)February</strong></td>
<td align="center">-3.015</td>
<td align="center">1.29</td>
<td align="center">-2.337</td>
<td align="center">0.02024</td>
</tr>
<tr class="even">
<td align="center"><strong>season(retail)March</strong></td>
<td align="center">0.07469</td>
<td align="center">1.29</td>
<td align="center">0.05791</td>
<td align="center">0.9539</td>
</tr>
<tr class="odd">
<td align="center"><strong>season(retail)April</strong></td>
<td align="center">3.447</td>
<td align="center">1.305</td>
<td align="center">2.641</td>
<td align="center">0.008801</td>
</tr>
<tr class="even">
<td align="center"><strong>season(retail)May</strong></td>
<td align="center">3.108</td>
<td align="center">1.305</td>
<td align="center">2.381</td>
<td align="center">0.01803</td>
</tr>
<tr class="odd">
<td align="center"><strong>season(retail)June</strong></td>
<td align="center">3.074</td>
<td align="center">1.305</td>
<td align="center">2.355</td>
<td align="center">0.01932</td>
</tr>
<tr class="even">
<td align="center"><strong>season(retail)July</strong></td>
<td align="center">6.053</td>
<td align="center">1.305</td>
<td align="center">4.638</td>
<td align="center">5.757e-06</td>
</tr>
<tr class="odd">
<td align="center"><strong>season(retail)August</strong></td>
<td align="center">3.138</td>
<td align="center">1.305</td>
<td align="center">2.404</td>
<td align="center">0.01695</td>
</tr>
<tr class="even">
<td align="center"><strong>season(retail)September</strong></td>
<td align="center">3.428</td>
<td align="center">1.305</td>
<td align="center">2.626</td>
<td align="center">0.009187</td>
</tr>
<tr class="odd">
<td align="center"><strong>season(retail)October</strong></td>
<td align="center">8.555</td>
<td align="center">1.305</td>
<td align="center">6.555</td>
<td align="center">3.336e-10</td>
</tr>
<tr class="even">
<td align="center"><strong>season(retail)November</strong></td>
<td align="center">20.82</td>
<td align="center">1.305</td>
<td align="center">15.95</td>
<td align="center">1.274e-39</td>
</tr>
<tr class="odd">
<td align="center"><strong>season(retail)December</strong></td>
<td align="center">52.54</td>
<td align="center">1.305</td>
<td align="center">40.25</td>
<td align="center">3.169e-109</td>
</tr>
<tr class="even">
<td align="center"><strong>time(retail)</strong></td>
<td align="center">3.67</td>
<td align="center">0.04369</td>
<td align="center">84</td>
<td align="center">5.206e-181</td>
</tr>
<tr class="odd">
<td align="center"><strong>(Intercept)</strong></td>
<td align="center">-7249</td>
<td align="center">87.24</td>
<td align="center">-83.1</td>
<td align="center">6.41e-180</td>
</tr>
</tbody>
</table>
<table style="width:85%;">
<caption>Fitting linear model: retail ~ season(retail) + time(retail)</caption>
<colgroup>
<col width="20%" />
<col width="30%" />
<col width="11%" />
<col width="22%" />
</colgroup>
<thead>
<tr class="header">
<th align="center">Observations</th>
<th align="center">Residual Std. Error</th>
<th align="center"><span class="math inline">\(R^2\)</span></th>
<th align="center">Adjusted <span class="math inline">\(R^2\)</span></th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="center">255</td>
<td align="center">4.278</td>
<td align="center">0.9767</td>
<td align="center">0.9755</td>
</tr>
</tbody>
</table>
<p>This <em>seems</em> like an effective model, explaining 0.98 of the variance in retail sales.</p>
</div>
<div id="c-14" class="section level3 unnumbered">
<h3>c</h3>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">xyplot</span>(<span class="kw">rstudent</span>(retail_lm) ~<span class="st"> </span><span class="kw">time</span>(retail), <span class="dt">type =</span> <span class="st">&quot;l&quot;</span>,
       <span class="dt">xlab =</span> <span class="st">&quot;Time&quot;</span>, <span class="dt">ylab =</span> <span class="st">&quot;Studentized residuals&quot;</span>,
       <span class="dt">panel =</span> function(x, y, ...) {
         <span class="kw">panel.xyplot</span>(x, y, ...)
         <span class="kw">panel.xyplot</span>(x, y, <span class="dt">pch =</span> <span class="kw">as.vector</span>(<span class="kw">season</span>(retail)), <span class="dt">col =</span> <span class="dv">1</span>)
       })</code></pre></div>
<div class="figure"><span id="fig:retail-res"></span>
<img src="TSAsolutions_files/figure-html/retail-res-1.png" alt="Studentized residuals for our seasonality + linear model of retail sales." width="576" />
<p class="caption">
Figure 3.12: Studentized residuals for our seasonality + linear model of retail sales.
</p>
</div>
<p>The residual plot (Figure <a href="trends.html#fig:retail-res">3.12</a>) tells a different story: we’re underpredicting values for early period and overpredicting values for the later years – however, this should be an easy fix.</p>
</div>
</div>
<div id="prescriptions" class="section level2">
<h2><span class="header-section-number">3.9</span> Prescriptions</h2>
<div id="a-26" class="section level3 unnumbered">
<h3>a</h3>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">data</span>(prescrip)
<span class="kw">xyplot</span>(prescrip, <span class="dt">ylab =</span> <span class="st">&quot;Prescription costs&quot;</span>,
       <span class="dt">panel =</span> function(x, y, ...) {
         <span class="kw">panel.xyplot</span>(x, y, ...)
         <span class="kw">panel.xyplot</span>(x, y, <span class="dt">pch =</span> <span class="kw">as.vector</span>(<span class="kw">season</span>(prescrip)), <span class="dt">col =</span> <span class="dv">1</span>)
       })</code></pre></div>
<div class="figure"><span id="fig:prescrip"></span>
<img src="TSAsolutions_files/figure-html/prescrip-1.png" alt="Monthly U.S. prescription costs." width="576" />
<p class="caption">
Figure 3.13: Monthly U.S. prescription costs.
</p>
</div>
<p>Figure <a href="trends.html#fig:prescrip">3.13</a> shows a clear, smooth, and cyclical seasonal trend. Values are genereally higher for the summer months and there seems to be an exponential increase long-term.</p>
</div>
<div id="b-26" class="section level3 unnumbered">
<h3>b</h3>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">pchange &lt;-<span class="st"> </span><span class="kw">diff</span>(prescrip) /<span class="st"> </span>prescrip
<span class="kw">xyplot</span>(pchange ~<span class="st"> </span><span class="kw">time</span>(prescrip), <span class="dt">type =</span> <span class="st">&quot;l&quot;</span>,
       <span class="dt">panel =</span> function(x, y, ...) {
         <span class="kw">panel.xyplot</span>(x, y, ...)
         <span class="kw">panel.xyplot</span>(x, y, <span class="dt">pch =</span> <span class="kw">as.vector</span>(<span class="kw">season</span>(pchange)), <span class="dt">col =</span> <span class="dv">1</span>)
       })</code></pre></div>
<div class="figure"><span id="fig:prescrip-diff"></span>
<img src="TSAsolutions_files/figure-html/prescrip-diff-1.png" alt="Percentage changes from month-to-month in prescription costs." width="576" />
<p class="caption">
Figure 3.14: Percentage changes from month-to-month in prescription costs.
</p>
</div>
<p>The monthly percentage difference series looks rather stationary.</p>
</div>
<div id="c-15" class="section level3 unnumbered">
<h3>c</h3>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">pres_cos &lt;-<span class="st"> </span><span class="kw">lm</span>(pchange ~<span class="st"> </span><span class="kw">harmonic</span>(pchange))
<span class="kw">pander</span>(<span class="kw">summary</span>(pres_cos))</code></pre></div>
<table>
<colgroup>
<col width="44%" />
<col width="13%" />
<col width="16%" />
<col width="12%" />
<col width="12%" />
</colgroup>
<thead>
<tr class="header">
<th align="center"> </th>
<th align="center">Estimate</th>
<th align="center">Std. Error</th>
<th align="center">t value</th>
<th align="center">Pr(&gt;|t|)</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="center"><strong>harmonic(pchange)cos(2<em>pi</em>t)</strong></td>
<td align="center">-0.006605</td>
<td align="center">0.003237</td>
<td align="center">-2.041</td>
<td align="center">0.04542</td>
</tr>
<tr class="even">
<td align="center"><strong>harmonic(pchange)sin(2<em>pi</em>t)</strong></td>
<td align="center">0.01612</td>
<td align="center">0.003208</td>
<td align="center">5.026</td>
<td align="center">4.291e-06</td>
</tr>
<tr class="odd">
<td align="center"><strong>(Intercept)</strong></td>
<td align="center">0.01159</td>
<td align="center">0.002282</td>
<td align="center">5.08</td>
<td align="center">3.508e-06</td>
</tr>
</tbody>
</table>
<table style="width:85%;">
<caption>Fitting linear model: pchange ~ harmonic(pchange)</caption>
<colgroup>
<col width="20%" />
<col width="30%" />
<col width="11%" />
<col width="22%" />
</colgroup>
<thead>
<tr class="header">
<th align="center">Observations</th>
<th align="center">Residual Std. Error</th>
<th align="center"><span class="math inline">\(R^2\)</span></th>
<th align="center">Adjusted <span class="math inline">\(R^2\)</span></th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="center">67</td>
<td align="center">0.01862</td>
<td align="center">0.3126</td>
<td align="center">0.2912</td>
</tr>
</tbody>
</table>
<p>We explain 0.31 of the variance. The model is significant though.</p>
</div>
<div id="d-5" class="section level3 unnumbered">
<h3>d</h3>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">xyplot</span>(<span class="kw">rstudent</span>(pres_cos) ~<span class="st"> </span><span class="kw">time</span>(prescrip), <span class="dt">type =</span> <span class="st">&quot;l&quot;</span>)</code></pre></div>
<div class="figure"><span id="fig:cos-resid"></span>
<img src="TSAsolutions_files/figure-html/cos-resid-1.png" alt="Residuals for our cosine model." width="576" />
<p class="caption">
Figure 3.15: Residuals for our cosine model.
</p>
</div>
<p>The residual plot in Figure <a href="#cos-resid"><strong>??</strong></a> looks rather random.</p>

</div>
</div>
</div>
            </section>

          </div>
        </div>
      </div>
<a href="fundamental-concepts.html" class="navigation navigation-prev navigation-unique" aria-label="Previous page"><i class="fa fa-angle-left"></i></a>

    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/lunr.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script>
require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": {
"github": false,
"facebook": true,
"twitter": true,
"google": false,
"weibo": false,
"instapper": false,
"vk": false,
"all": ["facebook", "google", "twitter", "weibo", "instapaper"]
},
"fontsettings": {
"theme": "white",
"family": "serif",
"size": 2
},
"edit": {
"link": "https://github.com/jolars/TSAsolutions/edit/master/03-trends.Rmd",
"text": "Edit"
},
"download": ["TSAsolutions.pdf", "TSAsolutions.epub"],
"toc": {
"collapse": "section"
}
});
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    script.src  = "https://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML";
    if (location.protocol !== "file:" && /^https?:/.test(script.src))
      script.src  = script.src.replace(/^https?:/, '');
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>
</body>

</html>
